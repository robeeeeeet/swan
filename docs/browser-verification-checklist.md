# Swan PWA ブラウザ検証チェックリスト

## 検証日: **\_\_\_\_**

## 🎯 検証環境

- [ ] デスクトップ Chrome（最新版）
- [ ] デスクトップ Firefox（最新版）
- [ ] iOS Safari 16.4+
- [ ] Android Chrome（最新版）

**開発サーバー起動**: `npm run dev`
**URL**: http://localhost:3000

---

## 1️⃣ 認証フロー

### 1.1 初回アクセス（未認証）

- [ ] `/` にアクセス → `/signin` にリダイレクトされる
- [x] サインインページが正しく表示される
- [x] 匿名ログインボタンが表示される
- [x] Google ログインボタンが表示される

### 1.2 匿名ログイン

- [x] 「匿名で始める」ボタンをクリック
- [ ] ローディング表示が出る
- [x] ログイン成功 → `/dashboard` にリダイレクト
- [x] エラーが出ない

### 1.3 認証状態の維持

- [x] ページをリロード → ログイン状態が維持される
- [x] ブラウザを閉じて再度開く → ログイン状態が維持される

---

## 2️⃣ ダッシュボード機能

### 2.1 レイアウト・ナビゲーション

- [x] ヘッダーに「ダッシュボード」タイトル表示
- [x] 右上に履歴アイコン（グラフ）表示
- [x] 右上に設定アイコン（歯車）表示
- [x] 各アイコンが 44px×44px の最小タッチターゲット
- [x] ダークモード対応（システム設定に応じて切り替わる）

### 2.2 目標進捗ヘッダー（B-01）

- [x] 「今日の目標：あと ○ 本」が表示される
- [x] 初回は目標本数が表示される（デフォルト 20 本）
- [x] 喫煙記録後、残り本数が減る
- [x] プログレスバーが表示される
- [ ] 目標達成時、メッセージが変わる
- [ ] 目標超過時、優しい表現で表示される

### 2.3 ランダム Tips（B-02）

- [x] Tips カードが表示される
- [x] Tips メッセージがランダムに表示される
- [x] ページをリロード → 異なる Tips が表示される可能性あり

### 2.4 成果可視化パネル（B-03） ✨ NEW!

- [x] 「あなたの成果」パネルが表示される
- [ ] グラデーション背景（Teal）が美しい
- [x] 4 つの指標が 2x2 グリッドで表示される：
  - [x] 💰 節約金額（¥ 形式）
  - [x] ⏰ 取り戻した時間（時間形式）
  - [x] 🏆 我慢成功回数（回）
  - [x] 📅 記録継続日数（日）
- [x] 各カードにホバー効果（scale-105）がある
- [x] 我慢成功回数が 1 以上の場合、励ましメッセージが表示される
- [ ] 励ましメッセージが成果に応じて変わる
- [x] 記録がない場合、パネルが非表示になる

### 2.5 記録ボタン（A-01, A-02, A-03）

- [x] 3 つの記録ボタンが表示される
- [x] **「吸った」ボタン**（グレー・ニュートラル）
  - [x] ボタンに今日のカウント表示
  - [x] クリック → タグ選択モーダル表示
- [x] **「吸いたい」ボタン**（オレンジ・警告）
  - [x] ボタンに今日のカウント表示
  - [x] クリック → SOS モーダル表示
- [x] **「我慢できた」ボタン**（グリーン・成功）
  - [x] ボタンに今日のカウント表示
  - [x] クリック → タグ選択モーダル表示

### 2.6 タグ選択モーダル（A-04）

- [x] モーダルが正しく表示される
- [x] モーダル背景が半透明（backdrop）
- [x] 10 種類のタグボタンが 2 列グリッドで表示される
- [x] 各タグに絵文字とラベルが表示される
- [x] タグをクリック → 選択状態になる（ティールの境界線）
- [x] 複数タグを選択できる
- [x] 「キャンセル」ボタンで閉じる
- [x] 「記録する」ボタンをクリック
  - [ ] ローディング表示（「記録中...」）
  - [x] 記録成功後、モーダルが閉じる
  - [ ] フィードバックメッセージが表示される
  - [x] カウントが更新される
  - [x] 成果可視化パネルの数値が更新される

### 2.7 今日の記録サマリー

- [x] 「今日の記録」カードが表示される
- [x] 3 つの統計が表示される：
  - [x] 吸った（グレー）
  - [x] 吸いたかった（オレンジ）
  - [x] 我慢できた（グリーン）
- [x] 各カウントが Tabular figures（桁揃え）で表示される

### 2.8 オフライン/同期状態

- [ ] オフライン時、「オフライン - データは後で同期されます」バナー表示
- [ ] 同期中、「同期中...」バナー表示
- [ ] オフライン時でも記録ボタンが動作する
- [ ] オンライン復帰後、自動的に同期される

---

## 3️⃣ SOS 機能（D 群）

### 3.1 SOS モーダル

- [x] ダッシュボードで「吸いたい」ボタンをクリック → SOS モーダル表示
- [x] モーダルに 3 つの選択肢が表示される：
  - [x] 3 分タイマー
  - [x] 深呼吸モード
  - [x] 記録だけする
- [x] 各選択肢に説明テキストがある
- [x] 「閉じる」ボタンで閉じる

### 3.2 3 分タイマー（D-01）

- [x] SOS モーダルで「3 分タイマー」選択 → `/sos/timer` に遷移
- [x] タイマー画面が表示される
- [x] 円形プログレスバー（SVG）が表示される
- [x] 大きく「3:00」と表示される（mm:ss 形式）
- [x] 「開始」ボタンをクリック
  - [x] カウントダウンが始まる
  - [x] 円形バーが時計回りに減っていく
  - [x] ボタンが「一時停止」に変わる
- [x] 「一時停止」ボタンをクリック → カウントダウンが止まる
- [x] 「リセット」ボタンをクリック → 3:00 に戻る
- [x] 3 分経過後
  - [x] 「完了！」メッセージ表示
  - [x] 祝福アニメーション表示（オプション）
  - [ ] 「ダッシュボードに戻る」ボタン表示
- [ ] 「ダッシュボードに戻る」ボタンで `/dashboard` に戻る

### 3.3 深呼吸モード（D-02）

- [x] SOS モーダルで「深呼吸モード」選択 → `/sos/breathing` に遷移
- [x] 深呼吸ガイド画面が表示される
- [x] 中央に呼吸サークル（円）が表示される
- [x] 「開始」ボタンをクリック
- [x] 呼吸ガイドが始まる：
  - [x] **吸って**（4 秒）→ 円が拡大、「吸って...」表示
  - [x] **止めて**（4 秒）→ 円が大きいまま、「止めて...」表示
  - [x] **吐いて**（6 秒）→ 円が縮小、「吐いて...」表示
  - [x] **休憩**（2 秒）→ 円が小さいまま、「休憩...」表示
- [x] プログレスバーが表示される（サイクル進捗）
- [x] 5 サイクル（約 80 秒）で完了
- [x] 完了後
  - [x] 「完了しました！」メッセージ表示
  - [ ] 「ダッシュボードに戻る」ボタン表示
- [ ] 「ダッシュボードに戻る」ボタンで `/dashboard` に戻る

---

## 4️⃣ 履歴ページ（E-03）

### 4.1 履歴ページへの遷移

- [x] ダッシュボード右上の履歴アイコンをクリック → `/history` に遷移
- [x] 履歴ページが表示される
- [x] ヘッダーに「履歴」タイトル表示
- [ ] 戻るボタン（←）が表示される

### 4.2 期間フィルター

- [x] 3 つのフィルターボタンが表示される：
  - [x] 7 日間
  - [x] 30 日間
  - [x] 全期間
- [x] 初期状態は「7 日間」が選択されている
- [x] 各ボタンをクリック → 期間が切り替わる
- [x] 選択中のボタンがハイライト表示される

### 4.3 週間統計カード（WeekStats）

- [x] 統計カードが表示される
- [x] グラデーション背景（Teal → Cyan）が美しい
- [x] 選択期間のラベルが表示される（例：「過去 7 日間の統計」）
- [x] 3 つの統計が表示される：
  - [x] 吸った本数
  - [x] 我慢成功回数
  - [x] 節約金額（¥ 形式）
- [ ] 励ましメッセージが表示される
- [ ] データがない場合、適切なメッセージ表示

### 4.4 本数推移チャート（SimpleBarChart）

- [x] 「直近 7 日間の推移」チャートが表示される
- [ ] 7 日分の棒グラフが表示される
- [ ] 今日のバーがティールでハイライト
- [ ] 過去のバーがグレー
- [ ] 各バーの上に本数が表示される
- [ ] X 軸に日付ラベル（月/日(曜日)形式）
- [ ] データがない日は 0 本として表示される

### 4.5 日別記録カード（HistoryCard）

- [x] 日別カードが新しい順に表示される
- [x] 各カードに以下が表示される：
  - [x] 日付ヘッダー（11 月 30 日(日)形式）
  - [x] 「今日」バッジ（今日のカードのみ）
  - [ ] 成功率バッジ（%表示、色分け）
  - [ ] 統計グリッド（吸った・我慢・節約）
  - [ ] タグプレビュー（最大 3 つ + 残数）
- [x] カードをタップ → 詳細モーダル表示
- [x] カードのホバー効果がある

### 4.6 日別詳細モーダル（DayDetailModal）

- [x] モーダルが正しく表示される
- [x] 日付と曜日が表示される
- [x] サマリー統計が表示される
- [x] **状況タグ分析**セクション
  - [x] タグごとの集計が表示される
  - [x] 絵文字 + ラベル + カウント
  - [x] 使用頻度の高い順に表示
- [x] **時間帯別ヒートマップ**セクション
  - [x] 0 時～ 23 時の 24 時間分表示
  - [ ] 記録がある時間帯が濃く表示される
  - [ ] 時刻ラベルが表示される
- [x] **記録タイムライン**セクション
  - [x] 時系列で記録が表示される
  - [x] 各記録に時刻、タイプ絵文字、タグ絵文字
  - [x] 新しい順に表示される
- [x] 「閉じる」ボタンで閉じる
- [x] モーダル外をクリックで閉じる

---

## 5️⃣ 設定ページ（F-01）

### 5.1 設定ページへの遷移

- [x] ダッシュボード右上の設定アイコンをクリック → `/settings` に遷移
- [x] 設定ページが表示される
- [x] ヘッダーに「設定」タイトル表示
- [x] 戻るボタン（←）が表示される

### 5.2 目標設定セクション（GoalSection）

- [x] 「目標設定」セクションが表示される
- [x] 日次目標本数の入力フィールド
  - [x] 現在の設定値が表示される（デフォルト 20）
  - [x] 数値を変更できる
  - [ ] 最小値 1、最大値 100 の制約
- [x] 自動ステップダウンのスイッチ
  - [x] ON にできる
  - [x] OFF にできる
  - [x] 説明テキストが表示される
- [x] 変更後、「保存しました ✓」メッセージが表示される

### 5.3 コスト設定セクション（CostSection）

- [x] 「コスト設定」セクションが表示される
- [x] タバコ価格（1 箱）の入力フィールド
  - [x] 現在の設定値が表示される（デフォルト 600 円）
  - [x] 価格を変更できる
- [x] 1 箱の本数の入力フィールド
  - [x] 現在の設定値が表示される（デフォルト 20 本）
  - [x] 本数を変更できる
- [x] 1 本あたり価格が自動計算される
  - [x] 例：600 円 ÷ 20 本 = 30 円/本
  - [x] 計算結果が表示される
- [x] 変更後、「保存しました ✓」メッセージが表示される

### 5.4 通知設定セクション（NotificationSection）

- [ ] 「通知設定」セクションが表示される
- [ ] **マスタースイッチ**
  - [ ] 通知全体の ON/OFF 切り替え
  - [ ] OFF 時、他の通知設定がグレーアウト
- [ ] **4 種類の通知**
  - [ ] モーニング・ブリーフィング
  - [ ] 魔の時間帯アラート
  - [ ] ステップダウン提案
  - [ ] 生存確認
  - [ ] 各通知に説明テキスト
- [ ] プライバシーモードスイッチ
  - [ ] ON/OFF 切り替え
  - [ ] 説明テキスト表示
- [ ] サイレント時間設定
  - [ ] 開始時刻（HH:MM 形式）
  - [ ] 終了時刻（HH:MM 形式）
- [ ] 変更後、「保存しました ✓」メッセージが表示される

### 5.5 アカウント管理セクション（AccountSection）

- [ ] 「アカウント管理」セクションが表示される
- [ ] アカウント種別表示
  - [ ] 匿名アカウントの場合：「匿名アカウント」バッジ
  - [ ] Google アカウントの場合：「Google アカウント」バッジ + メールアドレス
- [ ] **Google アカウント連携**（匿名ユーザーのみ）
  - [ ] 「Google アカウントと連携」ボタン表示
  - [ ] クリック → Google 認証フロー開始
  - [ ] 連携成功後、アカウント種別が更新される
- [ ] **サインアウト**ボタン
  - [ ] 赤色のボタン（危険操作）
  - [ ] クリック → 確認モーダル表示
  - [ ] 匿名ユーザーの場合、データ喪失警告表示
  - [ ] 確認後サインアウト → `/signin` にリダイレクト

---

## 6️⃣ データ永続化・同期

### 6.1 IndexedDB 保存

- [ ] ブラウザの DevTools > Application > IndexedDB を開く
- [ ] `SwanDB` データベースが存在する
- [ ] 4 つのオブジェクトストアが存在する：
  - [ ] records
  - [ ] summaries
  - [ ] settings
  - [ ] syncQueue
- [ ] 記録作成後、`records` に保存される
- [ ] サマリーが `summaries` に保存される
- [ ] 設定変更後、`settings` に保存される

### 6.2 オフライン動作

- [ ] DevTools > Network > Offline にチェック（オフラインモード）
- [ ] 「オフライン」バナーが表示される
- [ ] 記録ボタンが動作する
- [ ] 記録が IndexedDB に保存される
- [ ] `syncQueue` に同期待ちアイテムが追加される
- [ ] Offline チェックを外す（オンラインに戻る）
- [ ] 「同期中...」バナーが表示される
- [ ] 同期が完了する
- [ ] `syncQueue` が空になる

### 6.3 ページリロード

- [ ] 記録を作成
- [ ] ページをリロード（F5）
- [ ] 記録が保持されている
- [ ] カウントが正しい
- [ ] 統計が正しい

---

## 7️⃣ レスポンシブデザイン

### 7.1 モバイル表示（375px 幅）

- [ ] レイアウトが崩れない
- [ ] すべてのボタンが 44px×44px 以上
- [ ] テキストが読みやすい
- [ ] タップしやすい
- [ ] スクロールがスムーズ

### 7.2 タブレット表示（768px 幅）

- [ ] レイアウトが最適化されている
- [ ] グリッドレイアウトが適切
- [ ] 余白が美しい

### 7.3 デスクトップ表示（1024px 以上）

- [ ] 最大幅（max-w-2xl）で中央揃え
- [ ] 見やすいレイアウト
- [ ] ホバー効果が動作する

---

## 8️⃣ アクセシビリティ

### 8.1 キーボード操作

- [ ] Tab キーですべての要素に移動できる
- [ ] フォーカスリングが表示される
- [ ] Enter キーでボタンが押せる
- [ ] Esc キーでモーダルが閉じる

### 8.2 コントラスト比

- [ ] テキストが読みやすい（コントラスト比 4.5:1 以上）
- [ ] ボタンのラベルが明確
- [ ] ダークモードでも読みやすい

### 8.3 ARIA 属性

- [ ] ボタンに適切な aria-label
- [ ] モーダルに role="dialog"
- [ ] スイッチに role="switch", aria-checked

---

## 9️⃣ パフォーマンス

### 9.1 初期ロード

- [ ] ページが 3 秒以内に表示される
- [ ] ローディングインジケーターが表示される
- [ ] レイアウトシフトが少ない（CLS < 0.1）

### 9.2 操作レスポンス

- [ ] ボタンクリック → 100ms 以内に反応
- [ ] モーダル開閉がスムーズ
- [ ] アニメーションが滑らか（60fps）

---

## 🔟 エラーハンドリング

### 10.1 ネットワークエラー

- [ ] オフライン時でも操作できる
- [ ] 適切なエラーメッセージ表示
- [ ] リトライ機能が動作する

### 10.2 バリデーション

- [ ] 無効な入力値を受け付けない
- [ ] エラーメッセージが表示される
- [ ] フォームがリセットされない

---

## ✅ 検証結果サマリー

- **合格項目数**: **_ / _**
- **不具合発見数**: \_\_\_
- **重大度高**: \_\_\_
- **重大度中**: \_\_\_
- **重大度低**: \_\_\_

## 📝 発見した不具合

| No. | 重大度 | 機能 | 不具合内容 | 再現手順 |
| --- | ------ | ---- | ---------- | -------- |
| 1   |        |      |            |          |
| 2   |        |      |            |          |
| 3   |        |      |            |          |

## 💬 所感・改善提案

（検証を通じて感じたこと、改善案などを自由に記載）

---

**検証者**: **\*\***\_\_\_\_**\*\***
**検証完了日時**: \***\*\_\_\_\_\*\***
